{% extends "base.html" %}
{% load static %}

{% block css %}
  {{ block.super }}
  <style>
    #instrumentLevelButton {
      transition: background-color 0.3s, color 0.3s, opacity 0.3s; /* Smooth transitions */
      opacity: 0.5; /* Slightly transparent while disabled */
    }

    #instrumentLevelButton:disabled {
      background-color: #6c757d !important; /* Keep it gray while disabled */
      color: white !important; /* Text remains white for consistency */
      opacity: 0.5; /* Disabled button appears semi-transparent */
      cursor: not-allowed; /* Show disabled cursor */
    }

    #instrumentLevelButton:not(:disabled) {
      opacity: 1; /* Fully visible when enabled */
    }

    .tab-content {
      position: relative;
      overflow: hidden;
      height: 200px;
    }

    .tab-pane {
      position: absolute;
      width: 100%;
      top: 0;
      left: 0;
      transition: transform 0.5s ease, opacity 0.5s ease;
      opacity: 0;
      transform: translateX(100%);
      z-index: 0;
    }

    .tab-pane.slide-in-left {
      transform: translateX(0);
      opacity: 1;
      z-index: 1;
    }

    .tab-pane.slide-out-left {
      transform: translateX(-100%);
      opacity: 0;
      z-index: 0;
    }

    .tab-pane.slide-in-right {
      transform: translateX(0);
      opacity: 1;
      z-index: 1;
    }

    .tab-pane.slide-out-right {
      transform: translateX(100%);
      opacity: 0;
      z-index: 0;
    }

    /* Features section polish */
    #features {
      background: rgba(13, 110, 253, 0.08);
      border-top: 1px solid rgba(0, 0, 0, 0.05);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    #features .feature-card {
      transition: transform 200ms ease, box-shadow 200ms ease;
      border-radius: 0.75rem;
    }

    #features .feature-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 0.75rem 1.5rem rgba(0, 0, 0, 0.1);
    }

    /* Controls */
    #featuresCarousel .carousel-control-prev,
    #featuresCarousel .carousel-control-next {
      width: 3rem;
    }

    #featuresCarousel .carousel-control-prev .control-pill,
    #featuresCarousel .carousel-control-next .control-pill {
      background: #0d6efd;
      color: #fff;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0.5rem 1rem rgba(13, 110, 253, 0.25);
      transition: transform 150ms ease, background-color 150ms ease;
    }

    #featuresCarousel .carousel-control-prev:hover .control-pill,
    #featuresCarousel .carousel-control-next:hover .control-pill {
      transform: scale(1.05);
      background: #0b5ed7;
    }

    /* Indicators */
    #featuresCarousel .carousel-indicators [data-bs-target] {
      width: .75rem;
      height: .75rem;
      border-radius: 50%;
      background-color: rgba(13, 110, 253, .35);
    }

    #featuresCarousel .carousel-indicators .active {
      background-color: #0d6efd;
    }

    /* Faster slide transition feel */
    #featuresCarousel {
      --bs-carousel-transition-duration: .35s;
    }

    .carousel-indicators {
      position: relative !important;
    }
  </style>
{% endblock css %}

{% block body %}

  {% include 'navbar.html' %}

  {% include 'messages.html' %}

  <!-- Hero Section -->
  <section class="custom-lander text-white text-center py-5">
    <div class="overlay"></div>
    <div class="container position-relative">
      <h1 class="display-4">Master Your Notes, Master the Stage</h1>
      <p class="lead">A practice tool for musicians <b>at any stage</b> to improve their note recognition and playing
        skills—quickly and effectively.</p>
      <a href="#" class="btn btn-light btn-lg" style="text-shadow: none !important;">Get Started</a>
      <div class="pt-3" style="z-index: 10;">
        {% include 'phrase.html' %}
      </div>
      <div>Unless costs mount, will remain free

        <a class="text-white"
           href="https://github.com/andytwoods/learnmusic"
           target="_blank"
           data-bs-toggle="tooltip"
           data-bs-placement="bottom"
           title="MIT with Commons Clause License">
          <i class="fab fa-github me-2"></i>MIT-CC
        </a>
      </div>
    </div>


    <div class="container my-4">
      <div class="alert alert-warning d-flex align-items-center p-4" role="alert" style="text-shadow: none;">
        <div class="flex-shrink-0 me-3">
          <i class="fas fa-tools fa-3x" style="text-shadow: none;"></i>
        </div>
        <div style="text-shadow: none;">
          <h4 class="alert-heading mb-1" style="text-shadow: none;">Signup Currently Disabled</h4>
          <p class="mb-0">
            The app is not quite 'Minimum Viable Product' but you can try out the demo below!
          </p>
        </div>
      </div>
    </div>


  </section>

  <section class="py-5 alt-bg">
    <div class="overlay"></div>
    <div class="container position-relative">
      <h2 class="text-center mb-4">How It Works</h2>

      <div class="row justify-content-center mb-5">
        <div class="col-lg-10 text-center">
          <img src="{% static 'images/explainer.jpg' %}" class="img-fluid rounded shadow-sm" alt="How LearnMusic works">
        </div>
      </div>

      <div class="row g-4">
        <div class="col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm border-0 bg-light">
            <div class="card-body text-center">
              <div class="d-flex align-items-center justify-content-center mb-3">
                <i class="fas fa-calendar-check fa-2x text-primary me-3"></i>
                <h5 class="card-title mb-0">Daily exercises</h5>
              </div>
              <p class="card-text">Daily short exercises to strengthen the link between reading a note and playing it
                with the correct fingering.</p>
            </div>
          </div>
        </div>

        <div class="col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm border-0 bg-light">
            <div class="card-body text-center">
              <div class="d-flex align-items-center justify-content-center mb-3">
                <i class="fas fa-chart-line fa-2x text-success me-3"></i>
                <h5 class="card-title mb-0">Progressive Learning</h5>
              </div>
              <p class="card-text">You'll start with common notes, then gradually move into new key signatures,
                accidentals, and more complex patterns.</p>
            </div>
          </div>
        </div>

        <div class="col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm border-0 bg-light">
            <div class="card-body text-center">
              <div class="d-flex align-items-center justify-content-center mb-3">
                <i class="fas fa-trophy fa-2x text-warning me-3"></i>
                <h5 class="card-title mb-0">Advanced Challenges</h5>
              </div>
              <p class="card-text">Prefer a challenge? You can also practise transposing and other advanced skills to
                take your musicianship to the next level.</p>
            </div>
          </div>
        </div>

        <div class="col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm border-0 bg-light">
            <div class="card-body text-center">
              <div class="d-flex align-items-center justify-content-center mb-3">
                <i class="fas fa-dumbbell fa-2x text-info me-3"></i>
                <h5 class="card-title mb-0">Muscle memory</h5>
              </div>
              <p class="card-text">Customise your user interface so it matches how you play your instrument. Your
                practice fine tunes muscle memory.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-5 bg-light">
    <div class="container">
      <div class="text-center mb-3">
        <h2 class="mb-3">Have a go now!</h2>
        <small>
          <ul class="list-unstyled mb-0">
            <li>
              <i class="fas fa-chevron-right fa-xs me-2"></i>See <i class="fa-solid fa-edit"></i> menu to change
              instrument, difficulty, transposition...
            </li>
            <li>
              <i class="fas fa-chevron-right fa-xs me-2"></i>See <i class="fas fa-cog"></i> menu to move around user
              interface
            </li>
            <li>
              <i class="fas fa-chevron-right fa-xs me-2"></i>Do in a <a
              href="{% url 'practice-demo' %}"
              target="_blank">separate browser tab?</a>
              <i id="progress-info-trigger" class="fas fa-info-circle ms-2 text-muted" role="button" title="How saving works" aria-label="More info about saving"></i>
            </li>
            <script>
              (function () {
                function showProgressInfo() {
                  if (typeof Swal === 'undefined') {
                    alert(
                      "Saving your progress\n\n" +
                      "• Your progress is saved anonymously in your browser’s cache on this device.\n" +
                      "• You can bookmark this page’s URL to return and continue later.\n" +
                      "• Clearing site data (cache/storage) or using a different device/browser may remove this progress."
                    );
                    return;
                  }
                  Swal.fire({
                    icon: 'info',
                    html: `
                      <div class="text-start">
                        <ol class="list-group">
                          <li class="list-group-item border-0 ps-0">
                            In this tab, your progress is saved anonymously in your browser’s cache on this device.
                          </li>
                          <li class="list-group-item border-0 ps-0">
                            You can bookmark this page’s URL to return and continue later.
                          </li>
                          <li class="list-group-item border-0 ps-0">
                            Clearing site data (cache/storage) or using a different device/browser may remove this
                            progress.
                          </li>
                        </ol>
                      </div>
                    `,
                    confirmButtonText: 'Got it',
                    confirmButtonColor: '#0d6efd' // Bootstrap primary color
                  });
                }

                document.addEventListener('DOMContentLoaded', function () {
                  var el = document.getElementById('progress-info-trigger');
                  if (el) el.addEventListener('click', showProgressInfo);
                });
              })();
            </script>
            <style>
              .swal2-progress-info .swal2-title {
                font-weight: 700;
              }

              .swal2-progress-info .swal2-html-container {
                margin: 0.25rem 0 0;
                font-size: 0.95rem;
                line-height: 1.35;
              }
            </style>

            <!-- Removed Bootstrap modal previously here -->
          </ul>
        </small>

      </div>

      <div id="iframe-container" class="overflow-hidden"></div>


      {{ instruments|json_script:"instruments-data" }}
      <script>
        document.addEventListener("DOMContentLoaded", function () {

          // Get the container where the iframe will be added
          const container = document.getElementById("iframe-container");

          // Clear any existing content in the container (optional)
          container.innerHTML = "";

          // Create the iframe element
          const iframe = document.createElement("iframe");

          // Set iframe attributes
          iframe.src = {% url 'practice-demo' %};
          iframe.style.width = "100%"; // Take the full width of the parent
          iframe.style.height = "100%"; // Take the full height of the parent
          iframe.style.border = "none"; // Remove the border for a clean look
          iframe.onload = function () {
            try {
              const iframeContent = iframe.contentWindow.document.body;
              iframe.style.height = iframeContent.scrollHeight + 120 + "px"; // Adjust the height based on content
            } catch (err) {
              console.error("Unable to adjust iframe height due to cross-origin restrictions:", err);
            }
          };
          // Append the iframe within the container
          container.appendChild(iframe);
        });
      </script>
    </div>
  </section>


  <!-- Testimonials Section -->
  <section id="testimonials" class="py-5 alt-bg">
    <div class="container">
      <div class="text-center mb-4">
        <h2>What Users Say</h2>
        <p class="text-muted">Join thousands of musicians who’ve improved their skills!</p>
      </div>
      <div class="row">
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"This app has transformed the way I practice trumpet notes"</p>
            <footer class="blockquote-footer">Sara T.</footer>
          </blockquote>
        </div>
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"I’ve never been more confident playing the trombone. Thank you!"</p>
            <footer class="blockquote-footer">John D.</footer>
          </blockquote>
        </div>
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"Perfect for beginners and experienced musicians alike"</p>
            <footer class="blockquote-footer">Anna K.</footer>
          </blockquote>
        </div>
      </div>
    </div>
  </section>


  {% include 'footer.html' %}

{% endblock body %}

{% extends "base.html" %}
{% load static %}

{% block css %}
  {{ block.super }}
  <style>
    #instrumentLevelButton {
      transition: background-color 0.3s, color 0.3s, opacity 0.3s; /* Smooth transitions */
      opacity: 0.5; /* Slightly transparent while disabled */
    }

    #instrumentLevelButton:disabled {
      background-color: #6c757d !important; /* Keep it gray while disabled */
      color: white !important; /* Text remains white for consistency */
      opacity: 0.5; /* Disabled button appears semi-transparent */
      cursor: not-allowed; /* Show disabled cursor */
    }

    #instrumentLevelButton:not(:disabled) {
      opacity: 1; /* Fully visible when enabled */
    }
  </style>
{% endblock css %}

{% block body %}

  {% include 'navbar.html' %}

  {% include 'messages.html' %}

  <!-- Hero Section -->
  <section class="custom-lander text-white text-center py-5">
    <div class="overlay"></div>
    <div class="container position-relative">
      <h1 class="display-4">Master Your Notes, Master the Stage</h1>
      <p class="lead">A practice tool for musicians <b>at any stage</b> to improve their note recognition and playing
        skills—quickly and effectively.</p>
      <a href="#" class="btn btn-light btn-lg" style="text-shadow: none !important;">Get Started</a>
    </div>
  </section>

  <section class="pt-5">
    <div class="container text-center">
      <h2 class="mb-4">Have a go now!</h2>
      {{ instruments|json_script:"instruments-data" }}
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const url_start = "{{ request.scheme }}://{{ request.get_host }}/{{ practice_url }}/";
          loadIframe(url_start + 'Trumpet/treble/Bb/Beginner/')

        });

        function loadIframe(src) {
          // Get the container where the iframe will be added
          const container = document.getElementById("iframe-container");

          // Clear any existing content in the container (optional)
          container.innerHTML = "";

          // Create the iframe element
          const iframe = document.createElement("iframe");

          // Set iframe attributes
          iframe.src = src;
          iframe.style.width = "100%"; // Take the full width of the parent
          iframe.style.height = "100%"; // Take the full height of the parent
          iframe.style.border = "none"; // Remove the border for a clean look
          iframe.onload = function () {
            try {
              const iframeContent = iframe.contentWindow.document.body;
              iframe.style.height = iframeContent.scrollHeight + 120 + "px"; // Adjust the height based on content
            } catch (err) {
              console.error("Unable to adjust iframe height due to cross-origin restrictions:", err);
            }
          };
          // Append the iframe within the container
          container.appendChild(iframe);
        }
      </script>
    </div>
  </section>
  <div class="m-1">
    <div id="iframe-container">
      <!-- The iframe will be added here dynamically -->
    </div>
  </div>

  <!-- Features Section -->
  <section id="features" class="py-5">
    <div class="container">
      <div class="text-center mb-4">
        <h2>Why sign-up?</h2>
      </div>
      <div class="row g-2">
        <div class="col-md-4">
          <div class="card h-100 shadow-sm bg-light">
            <div class="card-body text-center">
              <h5 class="card-title"><i class="bi bi-music-note"></i> Learn new notes</h5>
              <p class="card-text">Exercises to help you learn new notes and improve fluency.</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card h-100 shadow-sm bg-light">
            <div class="card-body text-center">
              <h5 class="card-title"><i class="bi bi-bar-chart"></i> Track Your Progress</h5>
              <p class="card-text">Get detailed insights and analytics on where to focus.</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card h-100 shadow-sm bg-light">
            <div class="card-body text-center">
              <h5 class="card-title"><i class="bi bi-question-circle"></i> Fluency with transpositions</h5>
              <p class="card-text">Create your own exercises on specific transpositions.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- Testimonials Section -->
  <section id="testimonials" class="bg-light py-5">
    <div class="container">
      <div class="text-center mb-4">
        <h2>What Users Say</h2>
        <p class="text-muted">Join thousands of musicians who’ve improved their skills!</p>
      </div>
      <div class="row">
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"This app has transformed the way I practice trumpet notes."</p>
            <footer class="blockquote-footer">Sara T.</footer>
          </blockquote>
        </div>
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"I’ve never been more confident playing the trombone. Thank you!"</p>
            <footer class="blockquote-footer">John D.</footer>
          </blockquote>
        </div>
        <div class="col-md-4">
          <blockquote class="blockquote">
            <p>"Perfect for beginners and experienced musicians alike."</p>
            <footer class="blockquote-footer">Anna K.</footer>
          </blockquote>
        </div>
      </div>
    </div>
  </section>

  <footer class="bg-dark text-white py-4">
    <div class="container">
      <div class="row">
        <!-- About Section -->
        <div class="col-md-4">
          <h5>About Us</h5>
          <p>We create tools to help musicians practice effectively and grow to their full potential.</p>
        </div>
        <!-- Links Section -->
      </div>

      <div class="text-center mt-3">
        <p class="mb-0">&copy; {% now "Y" %} Tootomatic. All Rights Reserved.</p>
      </div>
    </div>
  </footer>
{% endblock body %}

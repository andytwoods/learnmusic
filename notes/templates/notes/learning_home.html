{% extends 'base.html' %}

{% block title %}
  Child Page Title
{% endblock %}

{% block css %}
  {{ block.super }}
  <style>
    /* Custom styles that can't be handled with Tailwind */
  </style>
{% endblock css %}

{% block content %}
  <div class="flex justify-center items-center">
    <div class="w-full md:w-1/2 text-center mb-6">
      <h2 class="text-2xl font-bold">Learning Manager</h2>
    </div>
  </div>
  <div class="flex flex-wrap justify-center items-center mb-6" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    {% for learningscenario in learningscenarios %}
      <div class="w-full md:w-1/2 px-2" id="learningscenario-{{ learningscenario.id }}">
        <div class="card bg-base-100 shadow-xl mb-4">
          <div class="card-body">
            <div class="flex justify-between items-start">
              <h2 class="card-title">
                {% if learningscenario.label %}{{ learningscenario.label }}{% else %}
                  {{ learningscenario.instrument_name }} {{ learningscenario.key }}
                {% endif %}
              </h2>
              <div class="dropdown dropdown-end">
                <div tabindex="0" role="button" class="btn btn-sm btn-ghost">
                  Options
                  <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </div>
                <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                  <li>
                    <a href="{% url 'edit-learning-scenario' pk=learningscenario.id %}">
                      Edit learning scenario
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'edit-learning-scenario-notes' pk=learningscenario.id %}">
                      Edit notes
                    </a>
                  </li>
                  <li>
                    <a hx-post="."
                       hx-no-confirm="true"
                       href="#"
                       hx-vals='{"action": "copy", "id": {{ learningscenario.id }}}'>
                      Copy
                    </a>
                  </li>
                  <li>
                    <a class="text-error"
                       hx-post="."
                       hx-target="#learningscenario-{{ learningscenario.id }}"
                       hx-swap="outerHTML"
                       hx-confirm="Are you sure you want to delete this item?"
                       hx-vals='{"action": "delete", "id": {{ learningscenario.id }}}'
                       href="#">
                      Delete
                    </a>
                  </li>
                </ul>
              </div>
            </div>

            <div class="mt-4">
              <div class="flex flex-wrap gap-2" role="toolbar" aria-label="Toolbar with button groups">
                <!-- Button Group for Practice Button and Dropdown -->
                <div class="dropdown">
                  <div tabindex="0" role="button" class="btn btn-primary">
                    <i class="fas fa-play mr-1"></i> Practice
                  </div>
                  <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                    <li>
                      <a href="{% url 'practice' learningscenario_id=learningscenario.id %}">
                        <i class="fas fa-play mr-1"></i> Standard Practice
                      </a>
                    </li>
                    <li>
                      <a href="{% url 'practice-sound' learningscenario_id=learningscenario.id %}">
                        <i class="fas fa-microphone mr-1"></i> Mic-based Practice
                      </a>
                    </li>
                  </ul>
                </div>

                <!-- See Progress Button -->
                <a class="btn btn-secondary"
                   href="{% url 'see-progress' learningscenario_id=learningscenario.id %}"
                   aria-label="See progress for the selected item">
                  <i class="fas fa-chart-line mr-1"></i> See Progress
                </a>
              </div>
            </div>

            <div class="divider"></div>

            <div class="text-sm">
              <div class="grid grid-cols-2 gap-2">
                <div>
                  <span class="font-semibold">Clef:</span> {{ learningscenario.clef }}
                  {% if learningscenario.transpose_key != "BL" %}
                    , transposing from:{{ learningscenario.transpose_key }}
                  {% endif %}
                </div>
                <div>
                  <span class="font-semibold">Level:</span> {{ learningscenario.level }}
                </div>
                <div>
                  <span class="font-semibold">Last practiced:</span>
                  <span class="badge badge-ghost">{{ learningscenario.last_practiced }}</span>
                </div>
                <div>
                  <span class="font-semibold">Days-old:</span>
                  <span class="badge badge-ghost">{{ learningscenario.days_old }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  <div class="flex justify-center items-center">
    <div class="w-full md:w-1/3 text-center">
      <a href="{% url 'new-learning-scenario' %}?" class="btn btn-primary btn-wide">
        <i class="fas fa-plus mr-1"></i> Set up a new learning scenario
      </a>
    </div>
  </div>
{% endblock content %}
